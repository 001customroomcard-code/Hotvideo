<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Romantic Viral Reels</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#000;--muted:rgba(255,255,255,0.92);--muted-2:rgba(255,255,255,0.6);--accent:#ff2d55}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    body{background:var(--bg);color:#fff;overflow:hidden}

    /* layout */
    .reel-container{height:100vh;width:100vw;overflow-y:scroll;scroll-snap-type:y mandatory;-webkit-overflow-scrolling:touch}
    .reel{position:relative;height:100vh;width:100vw;scroll-snap-align:start;display:flex;align-items:stretch;justify-content:center;background:#000}
    video{width:100%;height:100%;object-fit:cover;background:#000}

    /* left overlay (user + caption) */
    .overlay-left{position:absolute;left:16px;bottom:24px;z-index:30;max-width:66%;}
    .user-row{display:flex;align-items:center;gap:12px;margin-bottom:8px}
    .avatar{width:42px;height:42px;border-radius:50%;overflow:hidden;flex:0 0 42px;border:2px solid rgba(255,255,255,0.06)}
    .avatar img{width:100%;height:100%;object-fit:cover;display:block}
    .username{font-weight:700}
    .meta{font-size:13px;color:var(--muted-2);margin-top:2px}
    .caption{margin-top:8px;font-size:15px;line-height:1.25;color:var(--muted-2);max-width:420px}

    /* right action column */
    .actions{position:absolute;right:12px;bottom:90px;display:flex;flex-direction:column;align-items:center;gap:16px;z-index:30}
    .action-btn{width:56px;height:56px;border-radius:16px;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;border:none;color:#fff;font-size:22px;cursor:pointer;backdrop-filter:blur(4px)}
    .count{font-size:12px;margin-top:6px;color:var(--muted-2);text-align:center}

    /* follow button (bottom-left) */
    .bottom-bar{position:absolute;left:0;right:0;bottom:0;padding:12px 16px;background:linear-gradient(180deg,transparent,rgba(0,0,0,0.45));z-index:25;display:flex;align-items:center;gap:12px}
    .btn-circle{width:40px;height:40px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;border:none;background:rgba(255,255,255,0.06);color:#fff;font-size:18px}
    .follow{margin-left:8px;padding:4px 10px;border:none;border-radius:12px;background:linear-gradient(90deg,#405de6,#5851db,#833ab4,#c13584,#e1306c);color:#fff;font-weight:700;cursor:pointer}
    
    .follow[data-following='false']{background:linear-gradient(90deg,#405de6,#5851db,#833ab4,#c13584,#e1306c)}
    .follow[data-following='true']{background:rgba(255,255,255,0.12);color:#fff}

    /* big heart (double tap) */
    .big-heart{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%) scale(0);z-index:40;pointer-events:none;opacity:0}
    .big-heart svg{width:120px;height:120px;filter:drop-shadow(0 8px 40px rgba(0,0,0,0.6))}
    .big-heart.show{animation:pop .9s cubic-bezier(.2,.9,.3,1) forwards;opacity:1}
    @keyframes pop{0%{transform:translate(-50%,-50%) scale(0.3) rotate(-10deg);opacity:0}40%{transform:translate(-50%,-50%) scale(1.05) rotate(0);opacity:1}100%{transform:translate(-50%,-50%) scale(1) rotate(0);opacity:0}}

    /* sound toggle */
    .sound-toggle{position:absolute;top:20px;right:20px;width:48px;height:48px;border-radius:14px;background:rgba(0,0,0,0.55);border:none;color:#fff;font-size:20px;display:flex;align-items:center;justify-content:center;z-index:40;cursor:pointer;transition:transform .18s ease}
    .sound-toggle.pop{transform:scale(1.08)}

    /* comment modal */
    .comments-modal{position:fixed;left:0;right:0;bottom:0;top:0;background:rgba(0,0,0,0.6);display:none;align-items:flex-end;z-index:60}
    .comments-panel{background:#0b0b0b;border-top-left-radius:14px;border-top-right-radius:14px;padding:12px;max-height:75vh;overflow:auto}
    .comment{display:flex;gap:10px;padding:8px 6px;border-bottom:1px solid rgba(255,255,255,0.03)}
    .comment .who{font-weight:700}

    /* preloader */
    .preloader{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(0,0,0,0.3),transparent);z-index:20}
    .spinner{width:48px;height:48px;border-radius:50%;border:4px solid rgba(255,255,255,0.06);border-top-color:var(--muted);animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    /* small */
    @media (max-width:600px){.avatar{width:36px;height:36px}.action-btn{width:50px;height:50px}.sound-toggle{width:44px;height:44px}}
  </style>
</head>
<body>
  <div class="reel-container" id="reelContainer">
    <!-- Reel 1 -->
    <section class="reel" data-username="john_doe" data-caption="Best moments from today's matchüî•" data-liked="false" data-likes="856">
      <video src="reel1.mp4" muted playsinline preload="metadata"></video>

      <div class="overlay-left">
        <div class="user-row">
          <div class="avatar"><img src="avatar1.jpg" alt="john"></div>
          <div>
            <div class="username">@anonymous<button class="follow" data-following="false">Follow</button></div>
            <div class="meta">3h ‚Ä¢ School Reels</div>
          </div>
        </div>
        <div class="caption"><span class="caption-text">Best moments from today's matchüî•</span></div>
      </div>

      <div class="actions">
        <button class="action-btn like-btn" aria-label="Like">‚ù§</button>
        <div class="count like-count">856</div>
        <button class="action-btn comment-open" aria-label="Comment">üí¨</button>
        <div class="count comment-count">126</div>
        <button class="action-btn share-btn" aria-label="Share">‚Üó</button>
        <div class="count">Share</div>
      </div>

      <div class="big-heart">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 21s-7.5-4.35-9.5-7.5A5.5 5.5 0 0 1 6 3.5c1.9 0 3.1 1.1 3.5 1.9.4-.8 1.6-1.9 3.5-1.9a5.5 5.5 0 0 1 3.5 10.0C19.5 16.65 12 21 12 21z" fill="var(--accent)"/></svg>
      </div>

      <button class="sound-toggle" aria-label="Sound">üîá</button>

      <!-- <div class="preloader hidden"><div class="spinner"></div></div> -->

      <div class="bottom-bar">
        <!-- <button class="btn-circle">‚§¥</button> -->
        <!-- <button class="btn-circle">‚ãØ</button> -->
        <!-- <button class="follow" data-following="false">Follow</button> -->
      </div>
    </section>

    <!-- Reel 2 -->
    <section class="reel" data-username="sara._" data-caption="Indian Girl Kissing Video!!" data-liked="false" data-likes="987">
      <video src="reel2.mp4" muted playsinline preload="metadata"></video>

      <div class="overlay-left">
        <div class="user-row">
          <div class="avatar"><img src="avatar2.jpg" alt="sara"></div>
          <div>
            <div class="username">@sara._<button class="follow" data-following="false">Follow</button></div>
            <div class="meta">1d ‚Ä¢ Indian</div>
          </div>
        </div>
        <div class="caption"><span class="caption-text">Indian Girl Kissing Video‚ú®</span></div>
      </div>

      <div class="actions">
        <button class="action-btn like-btn">‚ù§</button>
        <div class="count like-count">987</div>
        <button class="action-btn comment-open">üí¨</button>
        <div class="count comment-count">163</div>
        <button class="action-btn share-btn">‚Üó</button>
        <div class="count">Share</div>
      </div>

      <div class="big-heart">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 21s-7.5-4.35-9.5-7.5A5.5 5.5 0 0 1 6 3.5c1.9 0 3.1 1.1 3.5 1.9.4-.8 1.6-1.9 3.5-1.9a5.5 5.5 0 0 1 3.5 10.0C19.5 16.65 12 21 12 21z" fill="var(--accent)"/></svg>
      </div>

      <button class="sound-toggle" aria-label="Sound">üîá</button>

      <!-- <div class="preloader hidden"><div class="spinner"></div></div> -->

      <div class="bottom-bar">
        <!-- <button class="btn-circle">‚§¥</button> -->
        <!-- <button class="btn-circle">‚ãØ</button> -->
        <!-- <button class="follow" data-following="false">Follow</button> -->
      </div>
    </section>

     <!-- Reel 3 -->
    <section class="reel" data-username="john_doe" data-caption="Husband Wife Romantic Video üíãüíã" data-liked="false" data-likes="0">
      <video src="reel3.mp4" muted playsinline preload="metadata"></video>

      <div class="overlay-left">
        <div class="user-row">
          <div class="avatar"><img src="avatar3.jpg" alt="john"></div>
          <div>
            <div class="username">@Siber_haqu<button class="follow" data-following="false">Follow</button></div>
            <div class="meta">23m ‚Ä¢ Romantic Moment</div>
          </div>
        </div>
        <div class="caption"><span class="caption-text">Husband Wife Romantic Video üíãüíã</span></div>
      </div>

      <div class="actions">
        <button class="action-btn like-btn" aria-label="Like">‚ù§</button>
        <div class="count like-count">0</div>
        <button class="action-btn comment-open" aria-label="Comment">üí¨</button>
        <div class="count comment-count">0</div>
        <button class="action-btn share-btn" aria-label="Share">‚Üó</button>
        <div class="count">Share</div>
      </div>

      <div class="big-heart">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 21s-7.5-4.35-9.5-7.5A5.5 5.5 0 0 1 6 3.5c1.9 0 3.1 1.1 3.5 1.9.4-.8 1.6-1.9 3.5-1.9a5.5 5.5 0 0 1 3.5 10.0C19.5 16.65 12 21 12 21z" fill="var(--accent)"/></svg>
      </div>

      <button class="sound-toggle" aria-label="Sound">üîá</button>

      <div class="preloader hidden"><div class="spinner"></div></div>

      <div class="bottom-bar">
        <!-- <button class="btn-circle">‚§¥</button> -->
        <!-- <button class="btn-circle">‚ãØ</button> -->
        <!-- <button class="follow" data-following="false">Follow</button> -->
      </div>
    </section>

    <!-- Reel 4 -->
    <section class="reel" data-username="john_doe" data-caption="Husband Wife Romantic Video üíãüíã" data-liked="false" data-likes="0">
      <video src="reel4.mp4" muted playsinline preload="metadata"></video>

      <div class="overlay-left">
        <div class="user-row">
          <div class="avatar"><img src="avatar3.jpg" alt="john"></div>
          <div>
            <div class="username">@Siber_haqu<button class="follow" data-following="false">Follow</button></div>
            <div class="meta">23m ‚Ä¢ Romantic Moment</div>
          </div>
        </div>
        <div class="caption"><span class="caption-text">Husband Wife Romantic Video üíãüíã</span></div>
      </div>

      <div class="actions">
        <button class="action-btn like-btn" aria-label="Like">‚ù§</button>
        <div class="count like-count">0</div>
        <button class="action-btn comment-open" aria-label="Comment">üí¨</button>
        <div class="count comment-count">0</div>
        <button class="action-btn share-btn" aria-label="Share">‚Üó</button>
        <div class="count">Share</div>
      </div>

      <div class="big-heart">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 21s-7.5-4.35-9.5-7.5A5.5 5.5 0 0 1 6 3.5c1.9 0 3.1 1.1 3.5 1.9.4-.8 1.6-1.9 3.5-1.9a5.5 5.5 0 0 1 3.5 10.0C19.5 16.65 12 21 12 21z" fill="var(--accent)"/></svg>
      </div>

      <button class="sound-toggle" aria-label="Sound">üîá</button>

      <div class="preloader hidden"><div class="spinner"></div></div>

      <div class="bottom-bar">
        <!-- <button class="btn-circle">‚§¥</button> -->
        <!-- <button class="btn-circle">‚ãØ</button> -->
        <!-- <button class="follow" data-following="false">Follow</button> -->
      </div>
    </section>
  </div>

  <!-- Comments modal -->
  <div class="comments-modal" id="commentsModal">
    <div class="comments-panel">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
        <strong>Comments</strong>
        <button id="closeComments" class="btn-circle">‚úï</button>
      </div>
      <div id="commentsList">
        <div class="comment"><div style="width:36px;height:36px;border-radius:50%;background:#333;display:inline-block;margin-right:8px"></div><div><div class="who">alice</div><div class="what">Nice play!</div></div></div>
        <div class="comment"><div style="width:36px;height:36px;border-radius:50%;background:#333;display:inline-block;margin-right:8px"></div><div><div class="who">mike</div><div class="what">üî•üî•üî•</div></div></div>
      </div>
      <div style="display:flex;gap:8px;margin-top:10px">
        <input id="commentInput" placeholder="Add a comment..." style="flex:1;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff" />
        <button id="sendComment" class="follow">Post</button>
      </div>
    </div>
  </div>

  <script>
    // Helpers
    const container = document.getElementById('reelContainer');
    const reels = Array.from(document.querySelectorAll('.reel'));
    const videos = reels.map(r => r.querySelector('video'));

    function showPreloader(reel, show){
      const p = reel.querySelector('.preloader');
      if(!p) return;
      p.classList.toggle('hidden', !show);
    }

    // Ensure every reel has a sound button (if not present)
    reels.forEach(r => {
      if(!r.querySelector('.sound-toggle')){
        const btn = document.createElement('button'); btn.className='sound-toggle'; btn.textContent='üîá'; r.appendChild(btn);
      }
    });

    // IntersectionObserver to autoplay visible video
    const io = new IntersectionObserver(entries=>{
      entries.forEach(entry=>{
        const vid = entry.target.querySelector('video');
        if(entry.isIntersecting && entry.intersectionRatio > 0.6){
          // play when mostly visible
          vid.play().catch(()=>{});
        } else { vid.pause(); }
      });
    },{threshold:[0.25,0.6,0.9]});
    reels.forEach(r=>io.observe(r));

    // auto-scroll to next when video ends
    videos.forEach((v,i)=>{
      v.addEventListener('ended', ()=>{
        const next = (i+1) % videos.length;
        container.scrollTo({top: next * window.innerHeight, behavior:'smooth'});
        setTimeout(()=>{ videos[next].play().catch(()=>{}); }, 420);
      });

      // show preloader while loading
      v.addEventListener('waiting', ()=>{ showPreloader(reels[i], true); });
      v.addEventListener('canplay', ()=>{ showPreloader(reels[i], false); });
    });

    // Like button and double-tap
    reels.forEach((reel, idx)=>{
      const likeBtn = reel.querySelector('.like-btn');
      const likeCountEl = reel.querySelector('.like-count');
      const bigHeart = reel.querySelector('.big-heart');

      function setLiked(liked){
        reel.dataset.liked = liked;
        likeBtn.style.background = liked ? 'rgba(255,45,85,0.12)' : '';
      }

      likeBtn.addEventListener('click', (e)=>{
        e.stopPropagation();
        const liked = reel.dataset.liked === 'true';
        reel.dataset.liked = (!liked).toString();
        const count = parseInt(reel.dataset.likes,10)||0;
        reel.dataset.likes = (!liked)?(count+1):Math.max(0,count-1);
        likeCountEl.textContent = reel.dataset.likes;
        setLiked(!liked);
      });

      // double-tap detection on video area
      let lastTap = 0;
      reel.addEventListener('click', (e)=>{
        const now = Date.now();
        if(now - lastTap < 300){
          // double tap
          reel.dataset.liked = 'true';
          const count = parseInt(reel.dataset.likes,10)||0;
          reel.dataset.likes = count+1;
          likeCountEl.textContent = reel.dataset.likes;

          // show big heart
          bigHeart.classList.remove('show'); void bigHeart.offsetWidth; bigHeart.classList.add('show');
          setTimeout(()=>bigHeart.classList.remove('show'),900);
        }
        lastTap = now;
      });
    });

    // Sound toggle (button + tap single)
    reels.forEach((reel)=>{
      const video = reel.querySelector('video');
      const soundBtn = reel.querySelector('.sound-toggle');

      const updateIcon = ()=>{ soundBtn.textContent = video.muted ? 'üîá' : 'üîä'; soundBtn.classList.add('pop'); setTimeout(()=>soundBtn.classList.remove('pop'),160); }

      // button click
      soundBtn.addEventListener('click', (e)=>{ e.stopPropagation(); video.muted = !video.muted; updateIcon(); });

      // single-tap toggles sound (ignore double-tap handled earlier)
      reel.addEventListener('click', (e)=>{
        if(e.detail === 2) return; // double-tap for like
        // find if video is playing / visible
        if(document.visibilityState === 'visible'){
          video.muted = !video.muted;
          updateIcon();
        }
      });

    });

    // Ensure sound button for currently visible reel reflects muted state
    function syncSoundIcons(){
      reels.forEach(r=>{ const vid = r.querySelector('video'); const s = r.querySelector('.sound-toggle'); if(s) s.textContent = vid.muted ? 'üîá' : 'üîä'; });
    }
    syncSoundIcons();

    // Follow button (local toggle; placeholder for API integration)
    document.querySelectorAll('.follow').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const following = btn.dataset.following === 'true';
        btn.dataset.following = (!following).toString();
        btn.textContent = following ? 'Follow' : 'Following';
        // Visual tweak
        if(!following){ btn.style.transform = 'scale(0.98)'; setTimeout(()=>btn.style.transform='scale(1)',180); }
        // TODO: call backend API to persist follow state
      });
    });

    // Comments modal
    const commentsModal = document.getElementById('commentsModal');
    document.querySelectorAll('.comment-open').forEach(btn=>btn.addEventListener('click',(e)=>{ e.stopPropagation(); commentsModal.style.display='flex'; }));
    document.getElementById('closeComments').addEventListener('click', ()=>{ commentsModal.style.display='none'; });
    document.getElementById('sendComment').addEventListener('click', ()=>{
      const val = document.getElementById('commentInput').value.trim(); if(!val) return;
      const node = document.createElement('div'); node.className='comment'; node.innerHTML = `<div style="width:36px;height:36px;border-radius:50%;background:#333;display:inline-block;margin-right:8px"></div><div><div class='who'>you</div><div class='what'>${escapeHtml(val)}</div></div>`;
      document.getElementById('commentsList').prepend(node); document.getElementById('commentInput').value='';
    });

    // Share button
    document.querySelectorAll('.share-btn').forEach(btn=>btn.addEventListener('click', ()=>{ navigator.clipboard?.writeText(location.href).then(()=>{ alert('Link copied to clipboard'); }).catch(()=>{ prompt('Copy this link', location.href); }); }));

    // Simple swipe navigation (touch)
    let startY = null; let isMoving=false;
    container.addEventListener('touchstart', (e)=>{ startY = e.touches[0].clientY; isMoving = true; });
    container.addEventListener('touchmove', (e)=>{ if(!isMoving) return; const dy = e.touches[0].clientY - startY; if(Math.abs(dy) > 120){ isMoving=false; if(dy>0){ /* swipe down */ container.scrollBy({top:-window.innerHeight,behavior:'smooth'});} else { container.scrollBy({top:window.innerHeight,behavior:'smooth'}); } } });
    container.addEventListener('touchend', ()=>{ startY=null; isMoving=false; });

    // Escape HTML
    function escapeHtml(str){ return str.replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

    // Initial: play first visible video
    window.addEventListener('load', ()=>{ setTimeout(()=>{ videos[0].play().catch(()=>{}); },200); });

    // sync icons when visibility changed
    document.addEventListener('visibilitychange', ()=>{ if(document.visibilityState==='visible') syncSoundIcons(); });

  </script>
</body>

</html>
